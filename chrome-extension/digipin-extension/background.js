import{d as r}from"./assets/index-z5kl_H7f.js";chrome.runtime.onInstalled.addListener(()=>{chrome.contextMenus.create({id:"digipin-convert",title:"Convert to DIGIPIN",contexts:["selection"]})});function a(c){if(!c)return null;const e=c.trim().match(/(-?\d+(\.\d+)?)[,\s]+(-?\d+(\.\d+)?)/);if(!e)return null;const i=Number(e[1]),t=Number(e[3]);return Number.isFinite(i)&&Number.isFinite(t)?{lat:i,lng:t}:null}chrome.contextMenus.onClicked.addListener(async c=>{if(c.menuItemId!=="digipin-convert")return;const e=a(c.selectionText||"");if(!e){chrome.notifications.create({type:"basic",iconUrl:"icons/icon128.png",title:"DIGIPIN",message:"Select coordinates like: 28.6139,77.2090"});return}try{const i=r.getDigiPin(e.lat,e.lng);await chrome.storage.local.set({lastResult:{type:"encode",input:`${e.lat},${e.lng}`,output:i,ts:Date.now()}}),chrome.notifications.create({type:"basic",iconUrl:"icons/icon128.png",title:"DIGIPIN",message:`Converted: ${i}`});try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t!=null&&t.id&&await chrome.scripting.executeScript({target:{tabId:t.id},func:o=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(o);{const n=document.createElement("textarea");n.value=o,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}}catch(n){console.log("Clipboard copy failed:",n)}},args:[i]})}catch(t){console.log("Script execution failed:",t)}}catch{chrome.notifications.create({type:"basic",iconUrl:"icons/icon128.png",title:"DIGIPIN",message:"Failed to convert selection."})}});
